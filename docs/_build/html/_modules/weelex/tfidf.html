

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>weelex.tfidf &mdash; Weelex 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Weelex
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Weelex</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>weelex.tfidf</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for weelex.tfidf</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">joblib</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">import</span> <span class="nn">spacy</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>

<span class="n">SPACY_MODEL</span> <span class="o">=</span> <span class="s1">&#39;de_core_news_lg&#39;</span>


<div class="viewcode-block" id="remove_urls"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.remove_urls">[docs]</a><span class="k">def</span> <span class="nf">remove_urls</span><span class="p">(</span><span class="n">texts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to remove URLs found in strings via regular expressions</span>

<span class="sd">    Args:</span>
<span class="sd">        texts (pandas.Series): Array with strings</span>

<span class="sd">    Returns:</span>
<span class="sd">        (pandas.Series): Array with urls removed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url_regex</span> <span class="o">=</span> <span class="s1">&#39;(https?\:\/\/)?www[1-9]?\.[^ ]&#39;</span>
    <span class="n">html_regex</span> <span class="o">=</span> <span class="s1">&#39;(&lt;?a )?href=&quot;[^&quot;]*&quot;( rel=&quot;[^&quot;]*&quot;)?( target=&quot;[^&quot;]*&quot;)?&gt;&#39;</span>

    <span class="c1"># start by replacing some false positives:</span>
    <span class="n">texts_clean</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;^\.</span><span class="si">{3}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\
                       <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;\.</span><span class="si">{3}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">texts_clean</span> <span class="o">=</span> <span class="n">texts_clean</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">html_regex</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># the &quot;proper&quot; url regex can easily match typos (i.e. missing spaces)</span>
    <span class="c1"># hence, a less robust url search is implemented</span>
    <span class="n">texts_clean</span> <span class="o">=</span> <span class="n">texts_clean</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">url_regex</span><span class="p">,</span> <span class="s1">&#39;&lt;URL&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts_clean</span> <span class="o">=</span> <span class="n">texts_clean</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;/a&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">texts_clean</span></div>


<div class="viewcode-block" id="TfidfCleaner"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.TfidfCleaner">[docs]</a><span class="k">class</span> <span class="nc">TfidfCleaner</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="TfidfCleaner.fit"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.TfidfCleaner.fit">[docs]</a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="TfidfCleaner.transform"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.TfidfCleaner.transform">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tfidf_cleanup</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="tfidf_cleanup"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.tfidf_cleanup">[docs]</a><span class="k">def</span> <span class="nf">tfidf_cleanup</span><span class="p">(</span><span class="n">texts</span><span class="p">):</span>
    <span class="n">parties</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;CDU&#39;</span><span class="p">,</span> <span class="s1">&#39;Cdu&#39;</span><span class="p">,</span> <span class="s1">&#39;cdu&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CSU&#39;</span><span class="p">,</span> <span class="s1">&#39;Csu&#39;</span><span class="p">,</span> <span class="s1">&#39;csu&#39;</span><span class="p">,</span>
        <span class="s1">&#39;AFD&#39;</span><span class="p">,</span> <span class="s1">&#39;Afd&#39;</span><span class="p">,</span> <span class="s1">&#39;AfD&#39;</span><span class="p">,</span> <span class="s1">&#39;afd&#39;</span><span class="p">,</span>
        <span class="s1">&#39;SPD&#39;</span><span class="p">,</span> <span class="s1">&#39;Spd&#39;</span><span class="p">,</span> <span class="s1">&#39;spd&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Grünen&#39;</span><span class="p">,</span> <span class="s1">&#39;Bündnis90&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Piratenpartei&#39;</span><span class="p">,</span>
        <span class="s1">&#39;FDP&#39;</span><span class="p">,</span> <span class="s1">&#39;Fdp&#39;</span><span class="p">,</span> <span class="s1">&#39;fdp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;NPD&#39;</span><span class="p">,</span> <span class="s1">&#39;Npd&#39;</span><span class="p">,</span> <span class="s1">&#39;npd&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ÖDP&#39;</span><span class="p">,</span> <span class="s1">&#39;Ödp&#39;</span><span class="p">,</span> <span class="s1">&#39;ödp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;FPÖ&#39;</span><span class="p">,</span> <span class="s1">&#39;Fpö&#39;</span><span class="p">,</span> <span class="s1">&#39;fpö&#39;</span><span class="p">,</span>
        <span class="s1">&#39;SPÖ&#39;</span><span class="p">,</span> <span class="s1">&#39;Spö&#39;</span><span class="p">,</span> <span class="s1">&#39;spö&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ÖVP&#39;</span><span class="p">,</span> <span class="s1">&#39;Övp&#39;</span><span class="p">,</span> <span class="s1">&#39;övp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;die Linke&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Republikaner&#39;</span><span class="p">,</span> <span class="s1">&#39;Republicans&#39;</span><span class="p">,</span> <span class="s1">&#39;republikaner&#39;</span><span class="p">,</span> <span class="s1">&#39;republicans&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Demokraten&#39;</span><span class="p">,</span> <span class="s1">&#39;Democrats&#39;</span><span class="p">,</span> <span class="s1">&#39;demokraten&#39;</span><span class="p">,</span> <span class="s1">&#39;democrats&#39;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">teams</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Borussia&#39;</span><span class="p">,</span> <span class="s1">&#39;borussia&#39;</span><span class="p">,</span> <span class="s1">&#39;borussen&#39;</span><span class="p">,</span> <span class="s1">&#39;Borussen&#39;</span><span class="p">,</span> <span class="s1">&#39;BVB&#39;</span><span class="p">,</span> <span class="s1">&#39;bvb&#39;</span>
        <span class="s1">&#39;FCB&#39;</span><span class="p">,</span> <span class="s1">&#39;FC Bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;fc bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;fcb&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Werder Bremen&#39;</span><span class="p">,</span> <span class="s1">&#39;Werder&#39;</span><span class="p">,</span> <span class="s1">&#39;werder&#39;</span><span class="p">,</span>
        <span class="s1">&#39; TSV&#39;</span><span class="p">,</span> <span class="s1">&#39; tsv&#39;</span><span class="p">,</span> <span class="s1">&#39;Eintracht&#39;</span><span class="p">,</span> <span class="s1">&#39;VfB&#39;</span><span class="p">,</span> <span class="s1">&#39;Hertha BSC&#39;</span><span class="p">,</span> <span class="s1">&#39;hertha bsc&#39;</span><span class="p">,</span>
        <span class="s1">&#39;hertha&#39;</span><span class="p">,</span> <span class="s1">&#39;Arminia Bielefeld&#39;</span><span class="p">,</span> <span class="s1">&#39;EffZee Köln&#39;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">replacement_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;FIFA&#39;</span><span class="p">:</span> <span class="s1">&#39;Fußball Verband&#39;</span><span class="p">,</span>
        <span class="s1">&#39;fifa&#39;</span><span class="p">:</span> <span class="s1">&#39;Fußball Verband&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DFB&#39;</span><span class="p">:</span> <span class="s1">&#39;Fußball Verband&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dfb&#39;</span><span class="p">:</span> <span class="s1">&#39;Fußball Verband&#39;</span><span class="p">,</span>
        <span class="s1">&#39;BuLi&#39;</span><span class="p">:</span> <span class="s1">&#39;Bundesliga&#39;</span><span class="p">,</span>
        <span class="s1">&#39;IOC&#39;</span><span class="p">:</span> <span class="s1">&#39;Olympisches Komitee&#39;</span><span class="p">,</span>
        <span class="s1">&#39;BuLa&#39;</span><span class="p">:</span> <span class="s1">&#39;Bundesland&#39;</span><span class="p">,</span>
        <span class="s1">&#39;NRW&#39;</span><span class="p">:</span> <span class="s1">&#39;Bundesland&#39;</span><span class="p">,</span>
        <span class="s1">&#39;kmh&#39;</span><span class="p">:</span> <span class="s1">&#39;Geschwindigkeit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;km/h&#39;</span><span class="p">:</span> <span class="s1">&#39;Geschwindigkeit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;5km&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Kilometer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;5 km&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Kilometer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;5 Km&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Kilometer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;kwh&#39;</span><span class="p">:</span> <span class="s1">&#39;Kilowatt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;kWh&#39;</span><span class="p">:</span> <span class="s1">&#39;Kilowatt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;kcal&#39;</span><span class="p">:</span> <span class="s1">&#39;Kalorien&#39;</span><span class="p">,</span>
        <span class="s1">&#39; OS &#39;</span><span class="p">:</span> <span class="s1">&#39; Betriebssystem &#39;</span><span class="p">,</span>
        <span class="s1">&#39;5kg&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Kilogramm&#39;</span><span class="p">,</span>
        <span class="s1">&#39;5 kg&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Kilogramm&#39;</span><span class="p">,</span>
        <span class="s1">&#39;LKA&#39;</span><span class="p">:</span> <span class="s1">&#39;Kriminalamt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;BKA&#39;</span><span class="p">:</span> <span class="s1">&#39;Kriminalamt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PLZ&#39;</span><span class="p">:</span> <span class="s1">&#39;Postleitzahl&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Tesla&#39;</span><span class="p">:</span> <span class="s1">&#39;Auto&#39;</span><span class="p">,</span>
        <span class="s1">&#39;5EUR&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Euro&#39;</span><span class="p">,</span>
        <span class="s1">&#39;5 EUR&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Euro&#39;</span><span class="p">,</span>
        <span class="s1">&#39;5 Eur&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Euro&#39;</span><span class="p">,</span>
        <span class="s1">&#39; EUR &#39;</span><span class="p">:</span> <span class="s1">&#39; Euro &#39;</span><span class="p">,</span>
        <span class="s1">&#39; EUR.&#39;</span><span class="p">:</span> <span class="s1">&#39; Euro.&#39;</span><span class="p">,</span>
        <span class="s1">&#39; EUR,&#39;</span><span class="p">:</span> <span class="s1">&#39; Euro,&#39;</span><span class="p">,</span>
        <span class="s1">&#39;5mm&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Milimeter&#39;</span><span class="p">,</span>
        <span class="s1">&#39;5 mm&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Milimeter&#39;</span><span class="p">,</span>
        <span class="s1">&#39;5 ltr&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Liter&#39;</span><span class="p">,</span>
        <span class="s1">&#39;5 Ltr&#39;</span><span class="p">:</span> <span class="s1">&#39;5 Liter&#39;</span><span class="p">,</span>
        <span class="s1">&#39;D Mark&#39;</span><span class="p">:</span> <span class="s1">&#39;Euro&#39;</span><span class="p">,</span>
        <span class="s1">&#39;D-Mark&#39;</span><span class="p">:</span> <span class="s1">&#39;Euro&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DMark&#39;</span><span class="p">:</span> <span class="s1">&#39;Euro&#39;</span><span class="p">,</span>
        <span class="s1">&#39;SUV&#39;</span><span class="p">:</span> <span class="s1">&#39;Auto&#39;</span><span class="p">,</span>
        <span class="s1">&#39; IT &#39;</span><span class="p">:</span> <span class="s1">&#39; Informationstechnologie &#39;</span><span class="p">,</span>
        <span class="s1">&#39;NGO&#39;</span><span class="p">:</span> <span class="s1">&#39;Organisation&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MWST&#39;</span><span class="p">:</span> <span class="s1">&#39;Mehrwertsteuer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mwst&#39;</span><span class="p">:</span> <span class="s1">&#39;Mehrwertsteuer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MwSt&#39;</span><span class="p">:</span> <span class="s1">&#39;Mehrwertsteuer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;den Nagel auf den Kopf&#39;</span><span class="p">:</span> <span class="s1">&#39;richtig&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ZDF&#39;</span><span class="p">:</span> <span class="s1">&#39;Fernsehsender&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ARD&#39;</span><span class="p">:</span> <span class="s1">&#39;Fernsehsender&#39;</span><span class="p">,</span>
        <span class="s1">&#39;RTL&#39;</span><span class="p">:</span> <span class="s1">&#39;Fernsehsender&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Pkw&#39;</span><span class="p">:</span> <span class="s1">&#39;Auto&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Lkw&#39;</span><span class="p">:</span> <span class="s1">&#39;Auto&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PKW&#39;</span><span class="p">:</span> <span class="s1">&#39;Auto&#39;</span><span class="p">,</span>
        <span class="s1">&#39;LKW&#39;</span><span class="p">:</span> <span class="s1">&#39;Auto&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Know-How&#39;</span><span class="p">:</span> <span class="s1">&#39;Wissen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Knowhow&#39;</span><span class="p">:</span> <span class="s1">&#39;Wissen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ã¤&#39;</span><span class="p">:</span> <span class="s1">&#39;ä&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ã¼&#39;</span><span class="p">:</span> <span class="s1">&#39;ü&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ã¶&#39;</span><span class="p">:</span> <span class="s1">&#39;ö&#39;</span><span class="p">,</span>
        <span class="c1">#&#39;Ã\\x9c&#39;: &#39;Ü&#39;,´</span>
        <span class="s1">&#39;ã</span><span class="se">\x9f</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;ß&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ã</span><span class="se">\\</span><span class="s1">x9f&#39;</span><span class="p">:</span> <span class="s1">&#39;ß&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Ã</span><span class="se">\x9c</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;Ü&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Ã</span><span class="se">\\</span><span class="s1">x9c&#39;</span><span class="p">:</span> <span class="s1">&#39;Ü&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Ã¼&#39;</span><span class="p">:</span> <span class="s1">&#39;Ü&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Ã¶&#39;</span><span class="p">:</span> <span class="s1">&#39;Ö&#39;</span> <span class="p">,</span>
        <span class="s1">&#39;Ã</span><span class="se">\x96</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;Ö&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Ã</span><span class="se">\\</span><span class="s1">x96&#39;</span><span class="p">:</span> <span class="s1">&#39;Ö&#39;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s1">&#39;Ã\x84&#39;</span><span class="p">:</span> <span class="s1">&#39;Ä&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Ã</span><span class="se">\x84</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;Ä&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Ã</span><span class="se">\\</span><span class="s1">x84&#39;</span><span class="p">:</span> <span class="s1">&#39;Ä&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">removes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;&amp;gt,&#39;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># otherwise encoding issues.</span>

    <span class="c1"># replace some of the most prominent politicians names with their profession</span>
    <span class="c1"># this is done 1) with first and last name and 2) only with last name to</span>
    <span class="c1"># avoid having gramatically incorrect remaining texts like</span>
    <span class="c1"># &quot;Angela Kanzlerin&quot;.</span>
    <span class="c1"># We need mostly functioning grammar for the tfidf-analyzer to do</span>
    <span class="c1"># successful part of speech tagging and named entity recognition.</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Angela Merkel&#39;</span><span class="p">,</span> <span class="s1">&#39;Kanzlerin&#39;</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Donald Trump&#39;</span><span class="p">,</span> <span class="s1">&#39;Präsident&#39;</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Merkel&#39;</span><span class="p">,</span> <span class="s1">&#39;Kanzlerin&#39;</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Trump&#39;</span><span class="p">,</span> <span class="s1">&#39;Präsident&#39;</span><span class="p">)</span>

    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[Aa]+ber&#39;</span><span class="p">,</span> <span class="s1">&#39;aber&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;NUM&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;5 [Mm]rd\.?&#39;</span><span class="p">,</span> <span class="s1">&#39;5 Milliarden&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;5 [Mm]io\.?&#39;</span><span class="p">,</span> <span class="s1">&#39;5 Millionen&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;5</span><span class="se">\\</span><span class="s1">xc5</span><span class="se">\\</span><span class="s1">x5&#39;</span><span class="p">,</span> <span class="s1">&#39;5 Euro&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;5 </span><span class="se">\\</span><span class="s1">xc5</span><span class="se">\\</span><span class="s1">x5&#39;</span><span class="p">,</span> <span class="s1">&#39;5 Euro&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;5T</span><span class="se">\\</span><span class="s1">xc5</span><span class="se">\\</span><span class="s1">x5&#39;</span><span class="p">,</span> <span class="s1">&#39;5 Euro&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;5T </span><span class="se">\\</span><span class="s1">xc5</span><span class="se">\\</span><span class="s1">x5&#39;</span><span class="p">,</span> <span class="s1">&#39;5 Euro&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;5M</span><span class="se">\\</span><span class="s1">xc5</span><span class="se">\\</span><span class="s1">x5&#39;</span><span class="p">,</span> <span class="s1">&#39;5 Euro&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;5M </span><span class="se">\\</span><span class="s1">xc5</span><span class="se">\\</span><span class="s1">x5&#39;</span><span class="p">,</span> <span class="s1">&#39;5 Euro&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="sa">r</span><span class="s1">&#39;Millionen </span><span class="se">\\</span><span class="s1">xc5</span><span class="se">\\</span><span class="s1">x5&#39;</span><span class="p">,</span> <span class="s1">&#39;Millionen Euro&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="sa">r</span><span class="s1">&#39;Milliarden </span><span class="se">\\</span><span class="s1">xc5</span><span class="se">\\</span><span class="s1">x5&#39;</span><span class="p">,</span> <span class="s1">&#39;Millionen Euro&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[MSD]eine Frau &#39;</span><span class="p">,</span> <span class="s1">&#39;Ehefrau&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; [msd]eine Frau&#39;</span><span class="p">,</span> <span class="s1">&#39; Ehefrau&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[MSD]ein Mann &#39;</span><span class="p">,</span> <span class="s1">&#39;Ehemann&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; [msd]ein Mann&#39;</span><span class="p">,</span> <span class="s1">&#39; Ehemann&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Ex-Mann&#39;</span><span class="p">,</span> <span class="s1">&#39;Ehemann&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1">#</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Ex-Männer&#39;</span><span class="p">,</span> <span class="s1">&#39;Ehemänner&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Ex-Frau&#39;</span><span class="p">,</span> <span class="s1">&#39;Ehefrau&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Ihre Frauen &#39;</span><span class="p">,</span> <span class="s1">&#39;Ehefrau&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ihre Frauen&#39;</span><span class="p">,</span> <span class="s1">&#39; Ehefrau&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Ihre Männer &#39;</span><span class="p">,</span> <span class="s1">&#39;Ehemann&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ihre Männer&#39;</span><span class="p">,</span> <span class="s1">&#39; Ehemann&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Ihre Frau &#39;</span><span class="p">,</span> <span class="s1">&#39;Ehefrau&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ihre Frau&#39;</span><span class="p">,</span> <span class="s1">&#39; Ehefrau&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Ihr Mann &#39;</span><span class="p">,</span> <span class="s1">&#39;Ehemann&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; ihr Mann&#39;</span><span class="p">,</span> <span class="s1">&#39; Ehemann&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;xcx&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Xcx&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;XCX&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;GroKo&#39;</span><span class="p">,</span> <span class="s1">&#39;Koalition&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;groko&#39;</span><span class="p">,</span> <span class="s1">&#39;Koalition&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Groko&#39;</span><span class="p">,</span> <span class="s1">&#39;Koalition&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># capture remaining URLs</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">remove_urls</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

    <span class="c1"># split words on hyphens</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">party</span> <span class="ow">in</span> <span class="n">parties</span><span class="p">:</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">party</span><span class="p">,</span> <span class="s1">&#39;Partei&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">teams</span><span class="p">:</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">team</span><span class="p">,</span> <span class="s1">&#39;Verein&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">replacement_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">removes</span><span class="p">:</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">texts</span></div>


<div class="viewcode-block" id="BasicTfidf"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf">[docs]</a><span class="k">class</span> <span class="nc">BasicTfidf</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">stopwords_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">relevant_pos</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ADJ&#39;</span><span class="p">,</span> <span class="s1">&#39;ADV&#39;</span><span class="p">,</span> <span class="s1">&#39;NOUN&#39;</span><span class="p">,</span> <span class="s1">&#39;VERB&#39;</span><span class="p">],</span>
                 <span class="n">min_df</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">max_df</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
                 <span class="n">spacy_model</span><span class="o">=</span><span class="n">SPACY_MODEL</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopwords_file</span> <span class="o">=</span> <span class="n">stopwords_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_df</span> <span class="o">=</span> <span class="n">min_df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_df</span> <span class="o">=</span> <span class="n">max_df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spacy_model_name</span> <span class="o">=</span> <span class="n">spacy_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spacy_model</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">spacy_model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retrieve_stopwords</span><span class="p">(</span>
            <span class="n">path</span><span class="o">=</span><span class="n">stopwords_file</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relevant_pos</span> <span class="o">=</span> <span class="n">relevant_pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_retrieve_stopwords</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">custom_sw</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">custom_sw</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">sw</span> <span class="o">=</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;german&#39;</span><span class="p">)</span>
        <span class="n">sw</span> <span class="o">=</span> <span class="n">sw</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">custom_sw</span>
        <span class="k">return</span> <span class="n">sw</span>

    <span class="k">def</span> <span class="nf">_get_params_from_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_analyzer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>

        <span class="c1"># setting up things for speedup</span>
        <span class="n">relevant_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relevant_pos</span>
        <span class="n">capitalize</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">capitalize</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="s1">&#39;[\-\.\,\#</span><span class="se">\&#39;\&quot;</span><span class="s1">\+\~\*\=\?\!\$\§\%\&amp;\/\(\)\[\]\{\}\&lt;\&gt;\|\^\°\_\:</span><span class="se">\\</span><span class="s1">\;]&#39;</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">append</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">append</span>
        <span class="n">sw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sw</span>

        <span class="c1"># tokenization</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spacy_model</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

        <span class="c1"># selecting words:</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">pos_</span>
            <span class="n">ent_type</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">ent_type_</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">relevant_pos</span> <span class="ow">and</span> <span class="n">ent_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PER&#39;</span><span class="p">,</span> <span class="s1">&#39;LOC&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">ent_type</span><span class="o">==</span><span class="s1">&#39;ADJ&#39;</span> <span class="ow">and</span> <span class="n">pos</span><span class="o">==</span><span class="s1">&#39;MISC&#39;</span><span class="p">):</span>  <span class="c1">#  capture nationalities</span>
                    <span class="n">word</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">lemma_</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">pos</span><span class="o">==</span><span class="s1">&#39;NOUN&#39;</span><span class="p">:</span>
                        <span class="n">word</span> <span class="o">=</span> <span class="n">capitalize</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">word</span> <span class="o">=</span> <span class="n">lower</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sw</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s1">&#39;xcx&#39;</span> <span class="ow">in</span> <span class="n">word</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s1">&#39;Xcx&#39;</span> <span class="ow">in</span> <span class="n">word</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s1">&#39;5&#39;</span> <span class="ow">in</span> <span class="n">word</span><span class="p">:</span>
                        <span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tokens</span>

<div class="viewcode-block" id="BasicTfidf.load"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
             <span class="n">zip_archive</span><span class="p">:</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">zip_archive</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">zip_archive</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></div>

<div class="viewcode-block" id="BasicTfidf.fit"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.fit">[docs]</a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fit vectorizer&#39;</span><span class="p">)</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">vectorizer_only</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span>
                <span class="n">analyzer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_analyzer</span><span class="p">,</span>
                <span class="c1">#stop_words=stopwords.words(&#39;german&#39;),  # not used if analyzer is callable</span>
                <span class="n">min_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_df</span><span class="p">,</span>
                <span class="n">max_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_df</span><span class="p">,</span>
                <span class="n">lowercase</span><span class="o">=</span><span class="kc">False</span><span class="p">,)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
            <span class="p">(</span><span class="s1">&#39;cleaner&#39;</span><span class="p">,</span> <span class="n">TfidfCleaner</span><span class="p">()),</span>
            <span class="p">(</span><span class="s1">&#39;vectorizer&#39;</span><span class="p">,</span> <span class="n">vectorizer_only</span><span class="p">)</span>
        <span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time to vectorize: </span><span class="si">{:0.2f}</span><span class="s1"> minutes&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_get_params_from_child</span><span class="p">()</span></div>

<div class="viewcode-block" id="BasicTfidf.transform"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.transform">[docs]</a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></div>

<div class="viewcode-block" id="BasicTfidf.fit_transform"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.fit_transform">[docs]</a>    <span class="k">def</span> <span class="nf">fit_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></div>

<div class="viewcode-block" id="BasicTfidf.check_fit"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.check_fit">[docs]</a>    <span class="k">def</span> <span class="nf">check_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span></div>

<div class="viewcode-block" id="BasicTfidf.save"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="c1"># exporting the different results from vectorization:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span></div>

    <span class="c1"># for compatibility, include all the other methods of the TfidfVectorizer class</span>
<div class="viewcode-block" id="BasicTfidf.get_feature_names"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.get_feature_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_feature_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()</span></div>

<div class="viewcode-block" id="BasicTfidf.get_feature_names_out"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.get_feature_names_out">[docs]</a>    <span class="k">def</span> <span class="nf">get_feature_names_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_features</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">(</span><span class="n">input_features</span><span class="o">=</span><span class="n">input_features</span><span class="p">)</span></div>

<div class="viewcode-block" id="BasicTfidf.get_params"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.get_params">[docs]</a>    <span class="k">def</span> <span class="nf">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">dct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">)</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;spacy_model&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">spacy_model_name</span><span class="p">,</span>
                    <span class="s1">&#39;stopwords_file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopwords_file</span><span class="p">,</span>
                    <span class="s1">&#39;relevant_pos&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">relevant_pos</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">dct</span></div>

<div class="viewcode-block" id="BasicTfidf.get_stop_words"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.get_stop_words">[docs]</a>    <span class="k">def</span> <span class="nf">get_stop_words</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sw</span></div>

<div class="viewcode-block" id="BasicTfidf.inverse_transform"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.inverse_transform">[docs]</a>    <span class="k">def</span> <span class="nf">inverse_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></div>

<div class="viewcode-block" id="BasicTfidf.set_params"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.set_params">[docs]</a>    <span class="k">def</span> <span class="nf">set_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;spacy_model&#39;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spacy_model_name</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;spacy_model&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spacy_model</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;spacy_model&#39;</span><span class="p">])</span>
            <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;spacy_model&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;stopwords_file&#39;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stopwords_file</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;stopwords_file&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retrieve_stopwords</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stopwords_file</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;stopwords_file&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;relevant_pos&#39;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relevant_pos</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;relevant_pos&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;relevant_pos&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="BasicTfidf.build_analyzer"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.build_analyzer">[docs]</a>    <span class="k">def</span> <span class="nf">build_analyzer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calls TfidfVectorizer build_analyzer() method.</span>
<span class="sd">        Does not include the proprocessing thus far.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">build_analyzer</span><span class="p">()</span></div>

<div class="viewcode-block" id="BasicTfidf.build_preprocessor"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.build_preprocessor">[docs]</a>    <span class="k">def</span> <span class="nf">build_preprocessor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span></div>

<div class="viewcode-block" id="BasicTfidf.build_tokenizer"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.build_tokenizer">[docs]</a>    <span class="k">def</span> <span class="nf">build_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calls TfidfVectorizer build_tokenizer() method.</span>
<span class="sd">        Does not include the preprocessing thus far.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">build_tokenizer</span><span class="p">()</span></div>

<div class="viewcode-block" id="BasicTfidf.decode"><a class="viewcode-back" href="../../weelex.html#weelex.tfidf.BasicTfidf.decode">[docs]</a>    <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vocabulary_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vocabulary_</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fixed_vocabulary_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fixed_vocabulary_</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">idf_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">idf_</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stop_words_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sw</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stop_words_</span><span class="p">)</span>
            <span class="p">))</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023, VFMR

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>